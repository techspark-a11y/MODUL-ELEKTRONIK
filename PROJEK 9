#define BLYNK_PRINT Serial

// Blynk Template Info
#define BLYNK_TEMPLATE_ID "TMPLxxxxxxx"
#define BLYNK_TEMPLATE_NAME "Motor DC L298N"
#define BLYNK_AUTH_TOKEN "ISI_AUTH_TOKEN"

#include <WiFi.h>
#include <WiFiClient.h>
#include <BlynkSimpleEsp32.h>

// WiFi
char ssid[] = "NAMA_WIFI";
char pass[] = "PASSWORD_WIFI";

// Motor Pins L298N
#define IN1 26
#define IN2 27
#define ENA 25   // PWM pin, HIGH untuk ON/OFF

BLYNK_WRITE(V0) {   // Button di Blynk
  int buttonState = param.asInt();

  if (buttonState == 1) {
    digitalWrite(IN1, HIGH);
    digitalWrite(IN2, LOW);
    digitalWrite(ENA, HIGH);  // Motor ON
  } else {
    digitalWrite(IN1, LOW);
    digitalWrite(IN2, LOW);
    digitalWrite(ENA, LOW);   // Motor OFF
  }
}

void setup() {
  Serial.begin(9600);

  pinMode(IN1, OUTPUT);
  pinMode(IN2, OUTPUT);
  pinMode(ENA, OUTPUT);

  // Pastikan motor OFF semasa mula
  digitalWrite(IN1, LOW);
  digitalWrite(IN2, LOW);
  digitalWrite(ENA, LOW);

  // Sambung ke Blynk IoT
  Blynk.begin(BLYNK_AUTH_TOKEN, ssid, pass);
}

void loop() {
  Blynk.run();
}
