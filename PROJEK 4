#define MQ2_PIN A0
#define LED_MERAH 9
#define LED_HIJAU 10
#define BUZZER 8
#define BUTTON_RESET 2

int ambangGas = 400;   // Nilai ambang gas (boleh dilaras)
bool sistemAktif = false;

void setup() {
  pinMode(LED_MERAH, OUTPUT);
  pinMode(LED_HIJAU, OUTPUT);
  pinMode(BUZZER, OUTPUT);
  pinMode(BUTTON_RESET, INPUT_PULLUP);

  digitalWrite(LED_HIJAU, HIGH);  // Keadaan selamat
  Serial.begin(9600);
}

void loop() {
  int bacaanGas = analogRead(MQ2_PIN);
  Serial.println(bacaanGas);

  // Jika gas berbahaya dikesan
  if (bacaanGas > ambangGas && !sistemAktif) {
    sistemAktif = true;
    digitalWrite(LED_MERAH, HIGH);
    digitalWrite(LED_HIJAU, LOW);
    digitalWrite(BUZZER, HIGH);
  }

  // Reset sistem menggunakan push button
  if (digitalRead(BUTTON_RESET) == LOW) {
    sistemAktif = false;
    digitalWrite(LED_MERAH, LOW);
    digitalWrite(LED_HIJAU, HIGH);
    digitalWrite(BUZZER, LOW);
    delay(300); // elak bouncing
  }
}
